// ... inside your index.html <script> tag ...

requestForm.onsubmit = async (e) => {
    e.preventDefault();
    const submitBtn = document.getElementById('submitBtn');
    const guestNameInput = document.getElementById('guestName'); // Get the input field
    submitBtn.disabled = true;
    submitBtn.innerText = "Sending...";

    const payload = {
        djName: djDropdown.value,
        guestName: guestNameInput.value, // Use the value
        song: document.getElementById('songRequest').value
    };

    try {
        await fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            body: JSON.stringify(payload)
        });

        // --- NEW: Personalize the success message ---
        const successTitle = document.querySelector('#successMessage h2');
        // Uses the guest's name, e.g., "Thanks, John!"
        successTitle.innerText = `Thanks, ${payload.guestName}!`; 
        // --------------------------------------------

        requestForm.classList.add('hidden');
        successMessage.classList.remove('hidden');
        djDropdown.parentElement.classList.add('hidden');
        
        // Clear the inputs for the next request
        guestNameInput.value = '';
        document.getElementById('songRequest').value = '';

    } catch (error) {
        alert("Connection error. Try again.");
        submitBtn.disabled = false;
        submitBtn.innerText = "Submit Request";
    }
};